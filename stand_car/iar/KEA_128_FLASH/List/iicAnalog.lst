###############################################################################
#
# IAR ANSI C/C++ Compiler V7.40.2.8542/W32 for ARM        28/Sep/2018  18:58:01
# Copyright 1999-2015 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\device\C\iicAnalog.c
#    Command line =  
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\device\C\iicAnalog.c -D IAR
#        -D TWR_K60N512 -D _DLIB_FILE_DESCRIPTOR -D DA_OLED -lCN
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\KEA_128_FLASH\List\ -lB
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\KEA_128_FLASH\List\ -o
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\KEA_128_FLASH\Obj\
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M0+ -e --fpu=None --dlib_config
#        F:\IAR∞≤◊∞∞¸\arm\INC\c\DLib_Config_Normal.h -I
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\..\device\H\ -I
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\..\user\H\ -I
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\..\system\ -I
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\..\lib\H\ -I
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\..\system\coreSupport\
#        -Ol
#    List file    =  
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\KEA_128_FLASH\List\iicAnalog.lst
#    Object file  =  
#        I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\iar\KEA_128_FLASH\Obj\iicAnalog.o
#
###############################################################################

I:\µÁ¥≈≥Ã–Ú-ZS\µÁ¥≈÷±¡¢-ZS\stand_ZS_9.28\device\C\iicAnalog.c
      1          /**
      2            ******************************************************************************
      3            * COPYRIGHT NOTICE
      4            * Copyright (c) 2018,ÂçéÂåóÁßëÊäÄÂ≠¶Èô¢
      5            * All rights reserved.
      6            *
      7            * Êñá‰ª∂ÂêçÁß∞Ôºö     iicAnalog.c
      8            * Êñá‰ª∂Ê†áËØÜÔºö
      9            * Êëò    Ë¶ÅÔºö
     10            *
     11            * ÂΩìÂâçÁâàÊú¨Ôºö     1.0
     12            * Ë¥ü    Ë¥£Ôºö     Èü©Âøó‰ºü
     13            * Êó∂    Èó¥Ôºö     2018Âπ¥1Êúà28Êó• 16:33:14
     14            ******************************************************************************
     15            */
     16          
     17          #include "iicAnalog.h"
     18          
     19          #define SDA             GpioGet (IIC_SDA)
     20          #define SDA0()          GpioSet (IIC_SDA, 0)		//IOÂè£ËæìÂá∫‰ΩéÁîµÂπ≥
     21          #define SDA1()          GpioSet (IIC_SDA, 1)		//IOÂè£ËæìÂá∫È´òÁîµÂπ≥
     22          #define SCL0()          GpioSet (IIC_SCL, 0)		//IOÂè£ËæìÂá∫‰ΩéÁîµÂπ≥
     23          #define SCL1()          GpioSet (IIC_SCL, 1)		//IOÂè£ËæìÂá∫È´òÁîµÂπ≥
     24          #define DIR_OUT()       gpio_ddr (IIC_SDA, GPO)    //ËæìÂá∫ÊñπÂêë
     25          #define DIR_IN()        gpio_ddr (IIC_SDA, GPI)    //ËæìÂÖ•ÊñπÂêë
     26          
     27          
     28          //ÂÜÖÈÉ®Êï∞ÊçÆÂÆö‰πâ

   \                                 In section .bss, align 1
     29          uint8 IIC_ad_main; //Âô®‰ª∂‰ªéÂú∞ÂùÄ
   \                     IIC_ad_main:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
     30          uint8 IIC_ad_sub;  //Âô®‰ª∂Â≠êÂú∞ÂùÄ
   \                     IIC_ad_sub:
   \   00000000                      DS8 1

   \                                 In section .bss, align 4
     31          uint8 *IIC_buf;    //ÂèëÈÄÅ|Êé•Êî∂Êï∞ÊçÆÁºìÂÜ≤Âå∫
   \                     IIC_buf:
   \   00000000                      DS8 4

   \                                 In section .bss, align 1
     32          uint8 IIC_num;     //ÂèëÈÄÅ|Êé•Êî∂Êï∞ÊçÆ‰∏™Êï∞
   \                     IIC_num:
   \   00000000                      DS8 1
     33          
     34          #define ack     1      //‰∏ªÂ∫îÁ≠î
     35          #define no_ack  0   //‰ªéÂ∫îÁ≠î
     36          
     37          
     38          /**
     39            * ÁÆÄ‰ªã
     40            *     Ê®°Êãü IIC Âª∂Êó∂
     41            * Â§áÊ≥®
     42            *     Â¶ÇÊûúIICÈÄö‰ø°Â§±Ë¥•ÔºåÂ∞ùËØïÂ¢ûÂä† j
     43            */

   \                                 In section .text, align 2, keep-with-next
     44          void IIC_delay(void)
     45          {
   \                     IIC_delay: (+1)
   \   00000000   0xB500             PUSH     {LR}
     46          	//64‰∏∫100KÁöÑÈÄüÁéá(busÈ¢ëÁéá‰∏∫100M)
     47          	//ÁâπÂà´ÊèêÁ§∫OV7725ÁöÑÈÄö‰ø°ÈÄüÁéá‰∏çËÉΩÂ§™È´òÔºåÊúÄÂ•Ω50KÂ∑¶Âè≥ÔºåjËÆæÁΩÆ‰∏∫120ÈÄö‰ø°ÈÄüÁéá‰∏∫60KÔºå60KÁöÑÊó∂ÂÄôÂèØ‰ª•Ê≠£Â∏∏ÈÄö‰ø°
     48          	//ÂÖ∂‰ªñIICÂô®‰ª∂‰∏ÄËà¨ÂèØ‰ª•400KÁöÑÈÄö‰ø°ÈÄüÁéá
     49          	uint16 j=120;
   \   00000002   0x2078             MOVS     R0,#+120
     50          	while(j--);
   \                     ??IIC_delay_0: (+1)
   \   00000004   0x0001             MOVS     R1,R0
   \   00000006   0x1E48             SUBS     R0,R1,#+1
   \   00000008   0xB289             UXTH     R1,R1
   \   0000000A   0x2900             CMP      R1,#+0
   \   0000000C   0xD1FA             BNE      ??IIC_delay_0
     51          }
   \   0000000E   0xBD00             POP      {PC}             ;; return
     52          
     53          /**
     54            * ÁÆÄ‰ªã
     55            *     IIC ÂºÄÂßãÂáΩÊï∞
     56            * Â§áÊ≥®
     57            *     ÂÜÖÈÉ®‰ΩøÁî®ÔºåÊó†ÈúÄË∞ÉÁî®
     58            */

   \                                 In section .text, align 2, keep-with-next
     59          void IIC_start(void)
     60          {
   \                     IIC_start: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     61          	SDA1();
   \   00000002   0x2101             MOVS     R1,#+1
   \   00000004   0x2017             MOVS     R0,#+23
   \   00000006   0x.... 0x....      BL       GpioSet
     62          	SCL1();
   \   0000000A   0x2101             MOVS     R1,#+1
   \   0000000C   0x201B             MOVS     R0,#+27
   \   0000000E   0x.... 0x....      BL       GpioSet
     63          	IIC_delay();
   \   00000012   0x.... 0x....      BL       IIC_delay
     64          	SDA0();
   \   00000016   0x2100             MOVS     R1,#+0
   \   00000018   0x2017             MOVS     R0,#+23
   \   0000001A   0x.... 0x....      BL       GpioSet
     65          	IIC_delay();
   \   0000001E   0x.... 0x....      BL       IIC_delay
     66          	SCL0();
   \   00000022   0x2100             MOVS     R1,#+0
   \   00000024   0x201B             MOVS     R0,#+27
   \   00000026   0x.... 0x....      BL       GpioSet
     67          }
   \   0000002A   0xBD01             POP      {R0,PC}          ;; return
     68          
     69          /**
     70            * ÁÆÄ‰ªã
     71            *     IIC ÂÅúÊ≠¢ÂáΩÊï∞
     72            * Â§áÊ≥®
     73            *     ÂÜÖÈÉ®‰ΩøÁî®ÔºåÊó†ÈúÄË∞ÉÁî®
     74            */

   \                                 In section .text, align 2, keep-with-next
     75          void IIC_stop(void)
     76          {
   \                     IIC_stop: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     77          	SDA0();
   \   00000002   0x2100             MOVS     R1,#+0
   \   00000004   0x2017             MOVS     R0,#+23
   \   00000006   0x.... 0x....      BL       GpioSet
     78          	SCL0();
   \   0000000A   0x2100             MOVS     R1,#+0
   \   0000000C   0x201B             MOVS     R0,#+27
   \   0000000E   0x.... 0x....      BL       GpioSet
     79          	IIC_delay();
   \   00000012   0x.... 0x....      BL       IIC_delay
     80          	SCL1();
   \   00000016   0x2101             MOVS     R1,#+1
   \   00000018   0x201B             MOVS     R0,#+27
   \   0000001A   0x.... 0x....      BL       GpioSet
     81          	IIC_delay();
   \   0000001E   0x.... 0x....      BL       IIC_delay
     82          	SDA1();
   \   00000022   0x2101             MOVS     R1,#+1
   \   00000024   0x2017             MOVS     R0,#+23
   \   00000026   0x.... 0x....      BL       GpioSet
     83          	IIC_delay();
   \   0000002A   0x.... 0x....      BL       IIC_delay
     84          }
   \   0000002E   0xBD01             POP      {R0,PC}          ;; return
     85          
     86          //‰∏ªÂ∫îÁ≠î(ÂåÖÂê´ack:SDA=0Âíåno_ack:SDA=0)
     87          //ÂÜÖÈÉ®‰ΩøÁî®ÔºåÁî®Êà∑Êó†ÈúÄË∞ÉÁî®

   \                                 In section .text, align 2, keep-with-next
     88          void I2C_SendACK(unsigned char ack_dat)
     89          {
   \                     I2C_SendACK: (+1)
   \   00000000   0xB510             PUSH     {R4,LR}
   \   00000002   0x0004             MOVS     R4,R0
     90              SCL0();
   \   00000004   0x2100             MOVS     R1,#+0
   \   00000006   0x201B             MOVS     R0,#+27
   \   00000008   0x.... 0x....      BL       GpioSet
     91          	IIC_delay();
   \   0000000C   0x.... 0x....      BL       IIC_delay
     92          	if(ack_dat) SDA0();
   \   00000010   0xB2E4             UXTB     R4,R4
   \   00000012   0x2C00             CMP      R4,#+0
   \   00000014   0xD004             BEQ      ??I2C_SendACK_0
   \   00000016   0x2100             MOVS     R1,#+0
   \   00000018   0x2017             MOVS     R0,#+23
   \   0000001A   0x.... 0x....      BL       GpioSet
   \   0000001E   0xE003             B        ??I2C_SendACK_1
     93              else    	SDA1();
   \                     ??I2C_SendACK_0: (+1)
   \   00000020   0x2101             MOVS     R1,#+1
   \   00000022   0x2017             MOVS     R0,#+23
   \   00000024   0x.... 0x....      BL       GpioSet
     94          
     95              SCL1();
   \                     ??I2C_SendACK_1: (+1)
   \   00000028   0x2101             MOVS     R1,#+1
   \   0000002A   0x201B             MOVS     R0,#+27
   \   0000002C   0x.... 0x....      BL       GpioSet
     96              IIC_delay();
   \   00000030   0x.... 0x....      BL       IIC_delay
     97              SCL0();
   \   00000034   0x2100             MOVS     R1,#+0
   \   00000036   0x201B             MOVS     R0,#+27
   \   00000038   0x.... 0x....      BL       GpioSet
     98              IIC_delay();
   \   0000003C   0x.... 0x....      BL       IIC_delay
     99          }
   \   00000040   0xBD10             POP      {R4,PC}          ;; return
    100          
    101          

   \                                 In section .text, align 2, keep-with-next
    102          static int SCCB_WaitAck(void)
    103          {
   \                     SCCB_WaitAck: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    104              SCL0();
   \   00000002   0x2100             MOVS     R1,#+0
   \   00000004   0x201B             MOVS     R0,#+27
   \   00000006   0x.... 0x....      BL       GpioSet
    105          	DIR_IN();
   \   0000000A   0x2100             MOVS     R1,#+0
   \   0000000C   0x2017             MOVS     R0,#+23
   \   0000000E   0x.... 0x....      BL       gpio_ddr
    106          	IIC_delay();
   \   00000012   0x.... 0x....      BL       IIC_delay
    107          
    108          	SCL1();
   \   00000016   0x2101             MOVS     R1,#+1
   \   00000018   0x201B             MOVS     R0,#+27
   \   0000001A   0x.... 0x....      BL       GpioSet
    109              IIC_delay();
   \   0000001E   0x.... 0x....      BL       IIC_delay
    110          
    111              if(SDA)           //Â∫îÁ≠î‰∏∫È´òÁîµÂπ≥ÔºåÂºÇÂ∏∏ÔºåÈÄö‰ø°Â§±Ë¥•
   \   00000022   0x2017             MOVS     R0,#+23
   \   00000024   0x.... 0x....      BL       GpioGet
   \   00000028   0x2800             CMP      R0,#+0
   \   0000002A   0xD009             BEQ      ??SCCB_WaitAck_0
    112              {
    113                  DIR_OUT();
   \   0000002C   0x2101             MOVS     R1,#+1
   \   0000002E   0x2017             MOVS     R0,#+23
   \   00000030   0x.... 0x....      BL       gpio_ddr
    114                  SCL0();
   \   00000034   0x2100             MOVS     R1,#+0
   \   00000036   0x201B             MOVS     R0,#+27
   \   00000038   0x.... 0x....      BL       GpioSet
    115                  return 0;
   \   0000003C   0x2000             MOVS     R0,#+0
   \   0000003E   0xE00A             B        ??SCCB_WaitAck_1
    116              }
    117              DIR_OUT();
   \                     ??SCCB_WaitAck_0: (+1)
   \   00000040   0x2101             MOVS     R1,#+1
   \   00000042   0x2017             MOVS     R0,#+23
   \   00000044   0x.... 0x....      BL       gpio_ddr
    118              SCL0();
   \   00000048   0x2100             MOVS     R1,#+0
   \   0000004A   0x201B             MOVS     R0,#+27
   \   0000004C   0x.... 0x....      BL       GpioSet
    119          	IIC_delay();
   \   00000050   0x.... 0x....      BL       IIC_delay
    120              return 1;
   \   00000054   0x2001             MOVS     R0,#+1
   \                     ??SCCB_WaitAck_1: (+1)
   \   00000056   0xBD02             POP      {R1,PC}          ;; return
    121          }
    122          
    123          /**
    124            * ÁÆÄ‰ªã
    125            *     IIC Â≠óËäÇÂèëÈÄÅÁ®ãÂ∫è
    126            * Â§áÊ≥®
    127            *     ÂèëÈÄÅc(ÂèØ‰ª•ÊòØÊï∞ÊçÆ‰πüÂèØÊòØÂú∞ÂùÄ)ÔºåÈÄÅÂÆåÂêéÊé•Êî∂‰ªéÂ∫îÁ≠î
    128            *     ‰∏çËÄÉËôë‰ªéÂ∫îÁ≠î‰Ωç
    129            *     ÂÜÖÈÉ®‰ΩøÁî®ÔºåÁî®Êà∑Êó†ÈúÄË∞ÉÁî®
    130            */

   \                                 In section .text, align 2, keep-with-next
    131          void send_ch(uint8 c)
    132          {
   \                     send_ch: (+1)
   \   00000000   0xB538             PUSH     {R3-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
    133          	uint8 i = 8;
   \   00000004   0x2508             MOVS     R5,#+8
   \   00000006   0xE010             B        ??send_ch_0
    134              while(i--)
    135              {
    136                  if(c & 0x80)	SDA1();//SDA ËæìÂá∫Êï∞ÊçÆ
    137                  else			SDA0();
   \                     ??send_ch_1: (+1)
   \   00000008   0x2100             MOVS     R1,#+0
   \   0000000A   0x2017             MOVS     R0,#+23
   \   0000000C   0x.... 0x....      BL       GpioSet
    138                  c <<= 1;
   \                     ??send_ch_2: (+1)
   \   00000010   0x0064             LSLS     R4,R4,#+1
    139                  IIC_delay();
   \   00000012   0x.... 0x....      BL       IIC_delay
    140                  SCL1();                //SCL ÊãâÈ´òÔºåÈááÈõÜ‰ø°Âè∑
   \   00000016   0x2101             MOVS     R1,#+1
   \   00000018   0x201B             MOVS     R0,#+27
   \   0000001A   0x.... 0x....      BL       GpioSet
    141                  IIC_delay();
   \   0000001E   0x.... 0x....      BL       IIC_delay
    142                  SCL0();                //SCL Êó∂ÈíüÁ∫øÊãâ‰Ωé
   \   00000022   0x2100             MOVS     R1,#+0
   \   00000024   0x201B             MOVS     R0,#+27
   \   00000026   0x.... 0x....      BL       GpioSet
   \                     ??send_ch_0: (+1)
   \   0000002A   0x0028             MOVS     R0,R5
   \   0000002C   0x1E45             SUBS     R5,R0,#+1
   \   0000002E   0xB2C0             UXTB     R0,R0
   \   00000030   0x2800             CMP      R0,#+0
   \   00000032   0xD006             BEQ      ??send_ch_3
   \   00000034   0x0620             LSLS     R0,R4,#+24
   \   00000036   0xD5E7             BPL      ??send_ch_1
   \   00000038   0x2101             MOVS     R1,#+1
   \   0000003A   0x2017             MOVS     R0,#+23
   \   0000003C   0x.... 0x....      BL       GpioSet
   \   00000040   0xE7E6             B        ??send_ch_2
    143              }
    144          	SCCB_WaitAck();
   \                     ??send_ch_3: (+1)
   \   00000042   0x.... 0x....      BL       SCCB_WaitAck
    145          }
   \   00000046   0xBD31             POP      {R0,R4,R5,PC}    ;; return
    146          
    147          /**
    148            * ÁÆÄ‰ªã
    149            *     IIC Â≠óËäÇÊé•Êî∂Á®ãÂ∫è
    150            * Â§áÊ≥®
    151            *     Êé•Êî∂Âô®‰ª∂‰º†Êù•ÁöÑÊï∞ÊçÆÔºå
    152            *     Ê≠§Á®ãÂ∫èÂ∫îÈÖçÂêà|‰∏ªÂ∫îÁ≠îÂáΩÊï∞|IIC_ack_main()‰ΩøÁî®
    153            *     ÂÜÖÈÉ®‰ΩøÁî®ÔºåÁî®Êà∑Êó†ÈúÄË∞ÉÁî®
    154            */

   \                                 In section .text, align 2, keep-with-next
    155          uint8 read_ch(void)
    156          {
   \                     read_ch: (+1)
   \   00000000   0xB538             PUSH     {R3-R5,LR}
    157              uint8 i;
    158              uint8 c;
    159              c=0;
   \   00000002   0x2500             MOVS     R5,#+0
    160              SCL0();
   \   00000004   0x2100             MOVS     R1,#+0
   \   00000006   0x201B             MOVS     R0,#+27
   \   00000008   0x.... 0x....      BL       GpioSet
    161              IIC_delay();
   \   0000000C   0x.... 0x....      BL       IIC_delay
    162              SDA1();             //ÁΩÆÊï∞ÊçÆÁ∫ø‰∏∫ËæìÂÖ•ÊñπÂºè
   \   00000010   0x2101             MOVS     R1,#+1
   \   00000012   0x2017             MOVS     R0,#+23
   \   00000014   0x.... 0x....      BL       GpioSet
    163              DIR_IN();
   \   00000018   0x2100             MOVS     R1,#+0
   \   0000001A   0x2017             MOVS     R0,#+23
   \   0000001C   0x.... 0x....      BL       gpio_ddr
    164              for(i=0;i<8;i++)
   \   00000020   0x2400             MOVS     R4,#+0
   \   00000022   0xE015             B        ??read_ch_0
    165              {
    166                  IIC_delay();
   \                     ??read_ch_1: (+1)
   \   00000024   0x.... 0x....      BL       IIC_delay
    167                  SCL0();         //ÁΩÆÊó∂ÈíüÁ∫ø‰∏∫‰ΩéÔºåÂáÜÂ§áÊé•Êî∂Êï∞ÊçÆ‰Ωç
   \   00000028   0x2100             MOVS     R1,#+0
   \   0000002A   0x201B             MOVS     R0,#+27
   \   0000002C   0x.... 0x....      BL       GpioSet
    168                  IIC_delay();
   \   00000030   0x.... 0x....      BL       IIC_delay
    169                  SCL1();         //ÁΩÆÊó∂ÈíüÁ∫ø‰∏∫È´òÔºå‰ΩøÊï∞ÊçÆÁ∫ø‰∏äÊï∞ÊçÆÊúâÊïà
   \   00000034   0x2101             MOVS     R1,#+1
   \   00000036   0x201B             MOVS     R0,#+27
   \   00000038   0x.... 0x....      BL       GpioSet
    170                  IIC_delay();
   \   0000003C   0x.... 0x....      BL       IIC_delay
    171                  c<<=1;
   \   00000040   0x006D             LSLS     R5,R5,#+1
    172                  if(SDA) c+=1;   //ËØªÊï∞ÊçÆ‰ΩçÔºåÂ∞ÜÊé•Êî∂ÁöÑÊï∞ÊçÆÂ≠òc
   \   00000042   0x2017             MOVS     R0,#+23
   \   00000044   0x.... 0x....      BL       GpioGet
   \   00000048   0x2800             CMP      R0,#+0
   \   0000004A   0xD000             BEQ      ??read_ch_2
   \   0000004C   0x1C6D             ADDS     R5,R5,#+1
    173              }
   \                     ??read_ch_2: (+1)
   \   0000004E   0x1C64             ADDS     R4,R4,#+1
   \                     ??read_ch_0: (+1)
   \   00000050   0xB2E4             UXTB     R4,R4
   \   00000052   0x2C08             CMP      R4,#+8
   \   00000054   0xDBE6             BLT      ??read_ch_1
    174              DIR_OUT();
   \   00000056   0x2101             MOVS     R1,#+1
   \   00000058   0x2017             MOVS     R0,#+23
   \   0000005A   0x.... 0x....      BL       gpio_ddr
    175          	SCL0();
   \   0000005E   0x2100             MOVS     R1,#+0
   \   00000060   0x201B             MOVS     R0,#+27
   \   00000062   0x.... 0x....      BL       GpioSet
    176          	IIC_delay();
   \   00000066   0x.... 0x....      BL       IIC_delay
    177          	I2C_SendACK(no_ack);
   \   0000006A   0x2000             MOVS     R0,#+0
   \   0000006C   0x.... 0x....      BL       I2C_SendACK
    178          
    179              return c;
   \   00000070   0x0028             MOVS     R0,R5
   \   00000072   0xB2C0             UXTB     R0,R0
   \   00000074   0xBD32             POP      {R1,R4,R5,PC}    ;; return
    180          }
    181          
    182          /**
    183            * ÁÆÄ‰ªã
    184            *     Ê®°ÊãüIICÂÜôÊï∞ÊçÆÂà∞ËÆæÂ§áÂØÑÂ≠òÂô®ÂáΩÊï∞
    185            * ÂèÇÊï∞
    186            *     dev_add			ËÆæÂ§áÂú∞ÂùÄ(‰Ωé‰∏É‰ΩçÂú∞ÂùÄ)
    187            *     reg				ÂØÑÂ≠òÂô®Âú∞ÂùÄ
    188            *     dat				ÂÜôÂÖ•ÁöÑÊï∞ÊçÆ
    189            */

   \                                 In section .text, align 2, keep-with-next
    190          void IIC_writeReg(uint8 dev_add, uint8 reg, uint8 dat)
    191          {
   \                     IIC_writeReg: (+1)
   \   00000000   0xB570             PUSH     {R4-R6,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
   \   00000006   0x0016             MOVS     R6,R2
    192          	IIC_start();
   \   00000008   0x.... 0x....      BL       IIC_start
    193              send_ch( (dev_add<<1) | 0x00);   //ÂèëÈÄÅÂô®‰ª∂Âú∞ÂùÄÂä†ÂÜô‰Ωç
   \   0000000C   0x0060             LSLS     R0,R4,#+1
   \   0000000E   0xB2C0             UXTB     R0,R0
   \   00000010   0x.... 0x....      BL       send_ch
    194          	send_ch( reg );   				 //ÂèëÈÄÅ‰ªéÊú∫ÂØÑÂ≠òÂô®Âú∞ÂùÄ
   \   00000014   0x0028             MOVS     R0,R5
   \   00000016   0xB2C0             UXTB     R0,R0
   \   00000018   0x.... 0x....      BL       send_ch
    195          	send_ch( dat );   				 //ÂèëÈÄÅÈúÄË¶ÅÂÜôÂÖ•ÁöÑÊï∞ÊçÆ
   \   0000001C   0x0030             MOVS     R0,R6
   \   0000001E   0xB2C0             UXTB     R0,R0
   \   00000020   0x.... 0x....      BL       send_ch
    196          	IIC_stop();
   \   00000024   0x.... 0x....      BL       IIC_stop
    197          }
   \   00000028   0xBD70             POP      {R4-R6,PC}       ;; return
    198          
    199          /**
    200            * ÁÆÄ‰ªã
    201            *     Ê®°Êãü IIC ‰ªéËÆæÂ§áÂØÑÂ≠òÂô®ËØªÂèñÊï∞ÊçÆ
    202            * ÂèÇÊï∞
    203            *     dev_add			ËÆæÂ§áÂú∞ÂùÄ(‰Ωé‰∏É‰ΩçÂú∞ÂùÄ)
    204            *     reg				ÂØÑÂ≠òÂô®Âú∞ÂùÄ
    205            *     type			ÈÄâÊã©ÈÄö‰ø°ÊñπÂºèÊòØIIC  ËøòÊòØ SCCB
    206            * ËøîÂõûÂÄº
    207            *     dat             ËøîÂõûÂØÑÂ≠òÂô®ÁöÑÊï∞ÊçÆ
    208            */

   \                                 In section .text, align 2, keep-with-next
    209          uint8 IIC_readReg(uint8 dev_add, uint8 reg, IIC_type type)
    210          {
   \                     IIC_readReg: (+1)
   \   00000000   0xB570             PUSH     {R4-R6,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
   \   00000006   0x0016             MOVS     R6,R2
    211          	uint8 dat;
    212          	IIC_start();
   \   00000008   0x.... 0x....      BL       IIC_start
    213              send_ch( (dev_add<<1) | 0x00);  //ÂèëÈÄÅÂô®‰ª∂Âú∞ÂùÄÂä†ÂÜô‰Ωç
   \   0000000C   0x0060             LSLS     R0,R4,#+1
   \   0000000E   0xB2C0             UXTB     R0,R0
   \   00000010   0x.... 0x....      BL       send_ch
    214          	send_ch( reg );   				//ÂèëÈÄÅ‰ªéÊú∫ÂØÑÂ≠òÂô®Âú∞ÂùÄ
   \   00000014   0x0028             MOVS     R0,R5
   \   00000016   0xB2C0             UXTB     R0,R0
   \   00000018   0x.... 0x....      BL       send_ch
    215          	if(type == SCCB)IIC_stop();
   \   0000001C   0xB2F6             UXTB     R6,R6
   \   0000001E   0x2E01             CMP      R6,#+1
   \   00000020   0xD101             BNE      ??IIC_readReg_0
   \   00000022   0x.... 0x....      BL       IIC_stop
    216          
    217          	IIC_start();
   \                     ??IIC_readReg_0: (+1)
   \   00000026   0x.... 0x....      BL       IIC_start
    218          	send_ch( (dev_add<<1) | 0x01);  //ÂèëÈÄÅÂô®‰ª∂Âú∞ÂùÄÂä†ËØª‰Ωç
   \   0000002A   0x0061             LSLS     R1,R4,#+1
   \   0000002C   0x2001             MOVS     R0,#+1
   \   0000002E   0x4308             ORRS     R0,R0,R1
   \   00000030   0xB2C0             UXTB     R0,R0
   \   00000032   0x.... 0x....      BL       send_ch
    219          	dat = read_ch();   				//ÂèëÈÄÅÈúÄË¶ÅÂÜôÂÖ•ÁöÑÊï∞ÊçÆ
   \   00000036   0x.... 0x....      BL       read_ch
   \   0000003A   0x0004             MOVS     R4,R0
    220          	IIC_stop();
   \   0000003C   0x.... 0x....      BL       IIC_stop
    221          
    222          	return dat;
   \   00000040   0x0020             MOVS     R0,R4
   \   00000042   0xB2C0             UXTB     R0,R0
   \   00000044   0xBD70             POP      {R4-R6,PC}       ;; return
    223          }
    224          
    225          /**
    226            * ÁÆÄ‰ªã
    227            *     IIC Á´ØÂè£Â§çÁî®
    228            * Â§áÊ≥®
    229            *
    230            */

   \                                 In section .text, align 2, keep-with-next
    231          void IIC_IoMux()
    232          {
    233              //Â∞Ü D3 Âèò‰∏∫ÂºïËÑöÂäüËÉΩ
    234              SIM->PINSEL1 |= SIM_PINSEL1_SPI1PS_MASK;
   \                     IIC_IoMux: (+1)
   \   00000000   0x....             LDR      R0,??DataTable0  ;; 0x40048010
   \   00000002   0x6800             LDR      R0,[R0, #+0]
   \   00000004   0x2180             MOVS     R1,#+128
   \   00000006   0x0109             LSLS     R1,R1,#+4        ;; #+2048
   \   00000008   0x4301             ORRS     R1,R1,R0
   \   0000000A   0x....             LDR      R0,??DataTable0  ;; 0x40048010
   \   0000000C   0x6001             STR      R1,[R0, #+0]
    235          
    236              //Â∞Ü C7 Âèò‰∏∫ÂºïËÑöÂäüËÉΩ
    237              SIM->PINSEL1 |= SIM_PINSEL1_UART1PS_MASK;;
   \   0000000E   0x....             LDR      R0,??DataTable0  ;; 0x40048010
   \   00000010   0x6800             LDR      R0,[R0, #+0]
   \   00000012   0x2180             MOVS     R1,#+128
   \   00000014   0x0149             LSLS     R1,R1,#+5        ;; #+4096
   \   00000016   0x4301             ORRS     R1,R1,R0
   \   00000018   0x....             LDR      R0,??DataTable0  ;; 0x40048010
   \   0000001A   0x6001             STR      R1,[R0, #+0]
    238          }
   \   0000001C   0x4770             BX       LR               ;; return
    239          
    240          /**
    241            * ÁÆÄ‰ªã
    242            *     IIC ÂàùÂßãÂåñ
    243            * Â§áÊ≥®
    244            *
    245            */

   \                                 In section .text, align 2, keep-with-next
    246          void IIC_Init(void)
    247          {
   \                     IIC_Init: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    248              IIC_IoMux();
   \   00000002   0x.... 0x....      BL       IIC_IoMux
    249          
    250          	GpioInit (IIC_SCL, GPO, 1);
   \   00000006   0x2201             MOVS     R2,#+1
   \   00000008   0x2101             MOVS     R1,#+1
   \   0000000A   0x201B             MOVS     R0,#+27
   \   0000000C   0x.... 0x....      BL       GpioInit
    251          	GpioInit (IIC_SDA, GPO, 1);
   \   00000010   0x2201             MOVS     R2,#+1
   \   00000012   0x2101             MOVS     R1,#+1
   \   00000014   0x2017             MOVS     R0,#+23
   \   00000016   0x.... 0x....      BL       GpioInit
    252          }
   \   0000001A   0xBD01             POP      {R0,PC}          ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable0:
   \   00000000   0x40048010         DC32     0x40048010
    253          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       8   I2C_SendACK
         8   -> GpioSet
         8   -> IIC_delay
       8   IIC_Init
         8   -> GpioInit
         8   -> IIC_IoMux
       0   IIC_IoMux
       4   IIC_delay
      16   IIC_readReg
        16   -> IIC_start
        16   -> IIC_stop
        16   -> read_ch
        16   -> send_ch
       8   IIC_start
         8   -> GpioSet
         8   -> IIC_delay
       8   IIC_stop
         8   -> GpioSet
         8   -> IIC_delay
      16   IIC_writeReg
        16   -> IIC_start
        16   -> IIC_stop
        16   -> send_ch
       8   SCCB_WaitAck
         8   -> GpioGet
         8   -> GpioSet
         8   -> IIC_delay
         8   -> gpio_ddr
      16   read_ch
        16   -> GpioGet
        16   -> GpioSet
        16   -> I2C_SendACK
        16   -> IIC_delay
        16   -> gpio_ddr
      16   send_ch
        16   -> GpioSet
        16   -> IIC_delay
        16   -> SCCB_WaitAck


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable0
      66  I2C_SendACK
      28  IIC_Init
      30  IIC_IoMux
       1  IIC_ad_main
       1  IIC_ad_sub
       4  IIC_buf
      16  IIC_delay
       1  IIC_num
      70  IIC_readReg
      44  IIC_start
      48  IIC_stop
      42  IIC_writeReg
      88  SCCB_WaitAck
     118  read_ch
      72  send_ch

 
   7 bytes in section .bss
 626 bytes in section .text
 
 626 bytes of CODE memory
   7 bytes of DATA memory

Errors: none
Warnings: none
